!function(e){"use strict";try{chrome.extension.getBackgroundPage().tgs.setViewGlobals(e)}catch(e){return void window.setTimeout((()=>window.location.reload()),1e3)}var t=!1,n=[];async function s(e){const t=await gsIndexedDb.fetchLastSession();if(t){gsUtils.removeInternalUrlsFromSession(t);for(const i of t.windows)for(const o of i.tabs)if(gsUtils.isSuspendedTab(o)){var s=gsUtils.getOriginalUrl(o.url);e.find((e=>e.url===s))||(o.windowId=i.id,o.sessionId=t.sessionId,n.push(o))}return n}}function i(e){const n=document.getElementById("recoveryTabs"),s=n.children;for(var i=0;i<s.length;i++){const t=s[i],o=gsUtils.isSuspendedTab(e)?gsUtils.getOriginalUrl(e.url):e.url;t.getAttribute("data-url")!==o&&t.getAttribute("data-tabId")!=e.id||n.removeChild(t)}0===document.getElementById("recoveryTabs").children.length&&(t?(document.getElementById("suspendy-guy-inprogress").style.display="none",document.getElementById("recovery-inprogress").style.display="none",document.getElementById("suspendy-guy-complete").style.display="inline-block",document.getElementById("recovery-complete").style.display="inline-block"):o())}function o(){for(var e=document.getElementsByClassName("recoverySection"),t=0;t<e.length;t++)e[t].style.display="none";document.getElementById("restoreSession").style.display="none"}gsUtils.documentReadyAndLocalisedAsPromsied(document).then((async function(){var e,n=document.getElementById("restoreSession"),r=document.getElementById("manageManuallyLink"),l=document.getElementById("previewsOffBtn"),a=document.getElementById("recoveryTabs"),c=document.getElementById("screenCaptureNotice");r.onclick=function(e){e.preventDefault(),chrome.tabs.create({url:chrome.extension.getURL("html/history.html")})},l&&(l.onclick=function(e){gsStorage.setOptionAndSync(gsStorage.SCREEN_CAPTURE,"0"),window.location.reload()},"0"!==gsStorage.getOption(gsStorage.SCREEN_CAPTURE)&&(c.style.display="block"));var d=async function(){for(t=!0,n.className+=" btnDisabled",n.removeEventListener("click",d),function(){for(var e=document.getElementById("recoveryTabs").children,t=0;t<e.length;t++){var n=e[t];n.removeChild(n.firstChild);var s=document.createElement("span");s.classList.add("faviconSpinner"),n.insertBefore(s,n.firstChild)}}();gsSession.isInitialising();)await gsUtils.setTimeout(200);await gsSession.recoverLostTabs()};n.addEventListener("click",d);const g=await gsChrome.tabsQuery(),u=await s(g);if(0!==u.length){for(var m of u)m.title=gsUtils.getCleanTabTitle(m),m.url=gsUtils.getOriginalUrl(m.url),(e=await historyItems.createTabHtml(m,!1)).onclick=function(){return function(e){e.preventDefault(),chrome.tabs.create({url:m.url,active:!1}),i(m)}},a.appendChild(e);var y=g.filter((e=>gsUtils.isSuspendedTab(e)));for(const e of y)gsMessages.sendPingToTab(e.id,(function(t){t?gsUtils.warning(e.id,"Failed to sendPingToTab",t):i(e)}))}else o()})),e.exports={removeTabFromList:i}}(this);