!function(e){"use strict";var t;chrome.extension.getBackgroundPage().tgs.setViewGlobals(e);var s=function(e,t){tgs.getActiveTabStatus((function(n){if(n!==gsUtils.STATUS_UNKNOWN&&n!==gsUtils.STATUS_LOADING)t(n);else if(0===e)t(n);else{var i=1e3;gsSession.isInitialising()||(e--,i=200),setTimeout((function(){s(e,t)}),i)}}))};function n(e,t){return new Promise((function(n){s(e,(function(e){t||e!==gsUtils.STATUS_UNKNOWN&&e!==gsUtils.STATUS_LOADING||(e="error"),n(e)}))}))}function i(e){var s,n,l;s=e,n=![gsUtils.STATUS_SUSPENDED,gsUtils.STATUS_SPECIAL,gsUtils.STATUS_BLOCKED_FILE,gsUtils.STATUS_UNKNOWN].includes(s),l=![gsUtils.STATUS_WHITELISTED,gsUtils.STATUS_SPECIAL,gsUtils.STATUS_BLOCKED_FILE,gsUtils.STATUS_UNKNOWN].includes(s),document.getElementById("suspendOne").style.display=n?"block":"none",l?(document.getElementById("whitelistPage").style.display="block",document.getElementById("whitelistDomain").style.display="block"):(document.getElementById("whitelistPage").style.display="none",document.getElementById("whitelistDomain").style.display="none"),document.getElementById("optsCurrent").style.display=n||l?"block":"none",document.getElementById("unsuspendOne").style.display="none";var o="";e===gsUtils.STATUS_NORMAL||e===gsUtils.STATUS_ACTIVE?o=chrome.i18n.getMessage("js_popup_normal")+" <a href='#'>"+chrome.i18n.getMessage("js_popup_normal_pause")+"</a>":e===gsUtils.STATUS_SUSPENDED?o=chrome.i18n.getMessage("js_popup_suspended"):e===gsUtils.STATUS_NEVER?o=chrome.i18n.getMessage("js_popup_never"):e===gsUtils.STATUS_SPECIAL?o=chrome.i18n.getMessage("js_popup_special"):e===gsUtils.STATUS_WHITELISTED?o=chrome.i18n.getMessage("js_popup_whitelisted")+" <a href='#'>"+chrome.i18n.getMessage("js_popup_whitelisted_remove")+"</a>":e===gsUtils.STATUS_AUDIBLE?o=chrome.i18n.getMessage("js_popup_audible"):e===gsUtils.STATUS_FORMINPUT?o=chrome.i18n.getMessage("js_popup_form_input")+" <a href='#'>"+chrome.i18n.getMessage("js_popup_form_input_unpause")+"</a>":e===gsUtils.STATUS_PINNED?o=chrome.i18n.getMessage("js_popup_pinned"):e===gsUtils.STATUS_TEMPWHITELIST?o=chrome.i18n.getMessage("js_popup_temp_whitelist")+" <a href='#'>"+chrome.i18n.getMessage("js_popup_temp_whitelist_unpause")+"</a>":e===gsUtils.STATUS_NOCONNECTIVITY?o=chrome.i18n.getMessage("js_popup_no_connectivity"):e===gsUtils.STATUS_CHARGING?o=chrome.i18n.getMessage("js_popup_charging"):e===gsUtils.STATUS_BLOCKED_FILE?o=chrome.i18n.getMessage("js_popup_blockedFile")+" <a href='#'>"+chrome.i18n.getMessage("js_popup_blockedFile_enable")+"</a>":e===gsUtils.STATUS_LOADING||e===gsUtils.STATUS_UNKNOWN?o=gsSession.isInitialising()?chrome.i18n.getMessage("js_popup_initialising"):chrome.i18n.getMessage("js_popup_unknown"):"error"===e?o=chrome.i18n.getMessage("js_popup_error"):gsUtils.warning("popup","Could not process tab status of: "+e),document.getElementById("statusDetail").innerHTML=o,document.getElementById("header").classList.remove("willSuspend"),e!==gsUtils.STATUS_NORMAL&&e!==gsUtils.STATUS_ACTIVE||document.getElementById("header").classList.add("willSuspend"),e===gsUtils.STATUS_BLOCKED_FILE&&document.getElementById("header").classList.add("blockedFile");var g,d=document.getElementsByTagName("a")[0];d&&(e===gsUtils.STATUS_NORMAL||e===gsUtils.STATUS_ACTIVE||e===gsUtils.STATUS_SUSPENDED?g=tgs.requestToggleTempWhitelistStateOfHighlightedTab:e===gsUtils.STATUS_WHITELISTED?g=tgs.unwhitelistHighlightedTab:e===gsUtils.STATUS_FORMINPUT||e===gsUtils.STATUS_TEMPWHITELIST?g=tgs.requestToggleTempWhitelistStateOfHighlightedTab:e===gsUtils.STATUS_BLOCKED_FILE&&(g=tgs.promptForFilePermissions),t&&d.removeEventListener("click",t),g&&(t=function(e){g((function(e){i(e)}))},d.addEventListener("click",t)))}Promise.all([gsUtils.documentReadyAndLocalisedAsPromsied(document),n(0,!0),new Promise((function(e){chrome.tabs.query({highlighted:!0,lastFocusedWindow:!0},(function(t){e(t)}))}))]).then((function([e,t,s]){!function(e){e&&e.length>1?document.getElementById("optsSelected").style.display="block":document.getElementById("optsSelected").style.display="none"}(s),i(t),function(){"dark"===gsStorage.getOption(gsStorage.THEME)&&document.body.classList.add("dark");setTimeout((function(){document.getElementById("popupContent").style.opacity=1}),200)}(),document.getElementById("unsuspendOne").addEventListener("click",(function(e){tgs.unsuspendHighlightedTab(),window.close()})),document.getElementById("suspendOne").addEventListener("click",(function(e){tgs.suspendHighlightedTab(),window.close()})),document.getElementById("suspendAll").addEventListener("click",(function(e){tgs.suspendAllTabs(!1),window.close()})),document.getElementById("unsuspendAll").addEventListener("click",(function(e){tgs.unsuspendAllTabs(),window.close()})),document.getElementById("suspendSelected").addEventListener("click",(function(e){tgs.suspendSelectedTabs(),window.close()})),document.getElementById("unsuspendSelected").addEventListener("click",(function(e){tgs.unsuspendSelectedTabs(),window.close()})),document.getElementById("whitelistDomain").addEventListener("click",(function(e){tgs.whitelistHighlightedTab(!1),i(gsUtils.STATUS_WHITELISTED)})),document.getElementById("whitelistPage").addEventListener("click",(function(e){tgs.whitelistHighlightedTab(!0),i(gsUtils.STATUS_WHITELISTED)})),document.getElementById("settingsLink").addEventListener("click",(function(e){chrome.tabs.create({url:chrome.extension.getURL("html/options.html")}),window.close()})),t!==gsUtils.STATUS_UNKNOWN&&t!==gsUtils.STATUS_LOADING||n(50,!1).then((function(e){i(e)}))}))}(this);