!function(e){try{chrome.extension.getBackgroundPage().tgs.setViewGlobals(e)}catch(e){return void window.setTimeout((()=>window.location.reload()),1e3)}var t={preview:gsStorage.SCREEN_CAPTURE,forceScreenCapture:gsStorage.SCREEN_CAPTURE_FORCE,suspendInPlaceOfDiscard:gsStorage.SUSPEND_IN_PLACE_OF_DISCARD,onlineCheck:gsStorage.IGNORE_WHEN_OFFLINE,batteryCheck:gsStorage.IGNORE_WHEN_CHARGING,unsuspendOnFocus:gsStorage.UNSUSPEND_ON_FOCUS,discardAfterSuspend:gsStorage.DISCARD_AFTER_SUSPEND,dontSuspendPinned:gsStorage.IGNORE_PINNED,dontSuspendForms:gsStorage.IGNORE_FORMS,dontSuspendAudio:gsStorage.IGNORE_AUDIO,dontSuspendActiveTabs:gsStorage.IGNORE_ACTIVE_TABS,ignoreCache:gsStorage.IGNORE_CACHE,addContextMenu:gsStorage.ADD_CONTEXT,syncSettings:gsStorage.SYNC_SETTINGS,timeToSuspend:gsStorage.SUSPEND_TIME,theme:gsStorage.THEME,whitelist:gsStorage.WHITELIST};function n(){var e,n,s,g=document.getElementsByClassName("option");for(s=0;s<g.length;s++)n=g[s],e=t[n.id],o(n,gsStorage.getOption(e));a("0"!==gsStorage.getOption(gsStorage.SCREEN_CAPTURE)),r(parseFloat(gsStorage.getOption(gsStorage.SUSPEND_TIME))>0),i(!gsStorage.getOption(gsStorage.SYNC_SETTINGS)),new URL(location.href).searchParams.has("firstTime")&&(document.querySelector(".welcome-message").classList.remove("reallyHidden"),document.querySelector("#options-heading").classList.add("reallyHidden"))}function o(e,t){"INPUT"===e.tagName&&e.hasAttribute("type")&&"checkbox"===e.getAttribute("type")?e.checked=t:"SELECT"===e.tagName?function(e,t){var n,o;for(n=0;n<e.children.length;n+=1)if((o=e.children[n]).value===t){o.selected="true";break}}(e,t):"TEXTAREA"===e.tagName&&(e.value=t)}function s(e){return"INPUT"===e.tagName&&e.hasAttribute("type")&&"checkbox"===e.getAttribute("type")?e.checked:"SELECT"===e.tagName?e.children[e.selectedIndex].value:"TEXTAREA"===e.tagName?e.value:void 0}function a(e){document.getElementById("forceScreenCaptureContainer").style.display=e?"block":"none"}function i(e){document.getElementById("syncNote").style.display=e?"block":"none"}function r(e){Array.prototype.forEach.call(document.getElementsByClassName("autoSuspendOption"),(function(t){t.style.display=e?"block":"none"}))}function g(e){return function(){var n=t[e.id];n===gsStorage.SCREEN_CAPTURE?a("0"!==s(e)):n===gsStorage.SUSPEND_TIME?r(s(e)>0):n===gsStorage.SYNC_SETTINGS&&s(e)&&i(!1);var[o,g]=function(e){var n=t[e.id],o=gsStorage.getOption(n),a=s(e);n===gsStorage.WHITELIST&&(a=gsUtils.cleanupWhitelist(a));o!==a&&gsStorage.setOptionAndSync(t[e.id],a);return[o,a]}(e);if(o!==g){var c=t[e.id];gsUtils.performPostSaveUpdates([c],{[c]:o},{[c]:g})}}}gsUtils.documentReadyAndLocalisedAsPromsied(document).then((function(){n();var e,t,o=document.getElementsByClassName("option");for(t=0;t<o.length;t++)"TEXTAREA"===(e=o[t]).tagName?e.addEventListener("input",gsUtils.debounce(g(e),200),!1):e.onchange=g(e);document.getElementById("testWhitelistBtn").onclick=async e=>{e.preventDefault();const t=(await gsChrome.tabsQuery()).map((e=>gsUtils.isSuspendedTab(e)?gsUtils.getOriginalUrl(e.url):e.url)).filter((e=>!gsUtils.isSuspendedUrl(e)&&gsUtils.checkWhiteList(e))).map((e=>e.length>55?e.substr(0,52)+"...":e));if(0===t.length)return void alert(chrome.i18n.getMessage("js_options_whitelist_no_matches"));const n=t.splice(0,22);let o=`${chrome.i18n.getMessage("js_options_whitelist_matches_heading")}\n${n.join("\n")}`;t.length>0&&(o+=`\n${chrome.i18n.getMessage("js_options_whitelist_matches_overflow_prefix")} ${t.length} ${chrome.i18n.getMessage("js_options_whitelist_matches_overflow_suffix")}`),alert(o)},chrome.extension.inIncognitoContext&&(Array.prototype.forEach.call(document.getElementsByClassName("noIncognito"),(function(e){e.style.display="none"})),window.alert(chrome.i18n.getMessage("js_options_incognito_warning")))})),e.exports={initSettings:n}}(this);